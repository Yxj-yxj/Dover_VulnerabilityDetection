from textrank4zh import TextRank4Keyword
import os
import json
from MagicGoogle import MagicGoogle
import google_search
import get_hostpage_text
from tld import get_tld
class list():
        path = "D:\XXAQJS\data\is_bug"
        files= os.listdir(path)
        name = []
        for root, dirs, files in os.walk(path):
            name.append(files)
        s = []
        j=0
        mg=MagicGoogle()
        for file,name in zip(files,name[0]):
             if not os.path.isdir(file):
                 Data=[]
                 word = TextRank4Keyword()
                 excel=google_search
                 text = open(path+"\\"+file, 'r').read()
                 word.analyze(text, window=2, lower=True)
                 w_list = word.get_keywords(num=6, word_min_len=1)
                 list=[x["word"] for x in w_list]
              #   Data=excel.google_web_search(",".join(list) + " language:en")
                 for i in mg.search(query=",".join(list), num=10):
                     try:
                         host=get_tld(i["url"])
                         host_text=get_hostpage_text.get_mainpage_txt(host)
                         i["host_page"]=host_text
                     except:
                         Data.append(i)
                         continue
                 f=open("D:\XXAQJS\data\json\\"+str(name),"w")
                 f.write(json.dumps(Data))
                 f.close()
                 j+=1
