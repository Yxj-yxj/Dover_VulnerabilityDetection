# -*- coding:utf8 -*-
import os
import re,json
class des():
    i=0
    result=dict()
    for root, dirs, files in os.walk("D:\XXAQJS\data\CVE-LIST"):
        for file in files:
            f=open(root+"\\"+file)
 #   f=open("D:\XXAQJS\data\CVE-LIST\\nvdcve-1.0-2018.json")
            myjson=json.load(f)
            for key in myjson:
                for dictlist in myjson["CVE_Items"]:
                    result[dictlist["cve"]["CVE_data_meta"]["ID"]]=dictlist["cve"]["description"]["description_data"][0]["value"]
                    i += 1
                    if(i%1000==0):print u"已提取完成"+str(i)+u"条CVE信息"
            print u"已完成"+file+u"的提取"
    description=json.dumps(result)
    fout = open("CVE_Descrition.json","w")
    fout.write(description)